//
//  TestDataProvider.swift
//  
//
//  Created by Dominik Mocher on 16.04.21.
//

import Foundation
import ValidationCore

struct TestDataProvider {
    let testData : [EuTestData]
    
    init(){
        let decoder = JSONDecoder()
        decoder.dateDecodingStrategy = .custom { decoder in
            let value = try decoder.singleValueContainer()
            let formatter = ISO8601DateFormatter()
            formatter.formatOptions = .withFractionalSeconds
            let iso8601FractionalSecondString = try value.decode(String.self)
            return formatter.date(from: iso8601FractionalSecondString)!
            
        }
        testData = try! decoder.decode([EuTestData].self, from: testDataString.data(using: .utf8)!)
    }
    
    struct Correct {
        static let ehnTestCertificate = TestData(encodedEhnCert: "HC1:NCFOXN%TS3DH0ZS2F97O2RXO5Y5CID:D4I$B%CM*Y4OBO*ZOJ*IMANZ9HPJPC%OQHIZC4VRMRPI:OI1%A395O.OAHA5VRCPIUF2FVPQJAZM93$UWW2QRA H99QHYOOQRA5RUXT25SIOH66L6SR9MU9DV5 R18AGZKHBKB3YUCIG%X4+$SS/CLS4:35HFER/F//CTIIH+G260H23+5JH$2.FV5DJ5DJBITEP47*KH-2.C30$9:Q6300AL8GWKSMIMXAH:O/B9/UIQRAFTQ2JATK2YJADG6JD3YW4:3TLD37UJBG7ME7ND33836:IOS0LS400T*OVAZ2M$BO.A29BLZI19JA2K7VA$IJVTIWZJ$7K+ CUEDDIKZ9C.PDH0JW1JY*R/8BN-A1DLNCKQ20HT8NN8VI9 KE.I90QN5IKXBHLII3.K$JL4HG9LN$II-GG0JIBHH.HIEKNTII7JJ-92$P6JD1F671NI+*RPKAOSHB.IUK96QF1%1RMN661V+JW29:VB/8TEXOV8O/DR-Z644SCL9U-LV5UD2MQAE5PTDRAP17+6D$P8HVK7DMZ5H$VPT406H5K5", keyId: "8TRqlBQxUbQ", encodedSigningCert: "MIIBIzCByqADAgECAgQbc6tlMAoGCCqGSM49BAMCMBAxDjAMBgNVBAMMBUVDLU1lMB4XDTIxMDQyMDA3Mjg1MVoXDTIxMDUyMDA3Mjg1MVowEDEOMAwGA1UEAwwFRUMtTWUwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASAnF9trnoiLJxV8zkWDCv4jM9/ls3bC5vVt/+oXkgHCOndb7e/7stg1OP64Gh3l/k64MlTBdR448bQA1IPXgOcoxIwEDAOBgNVHQ8BAf8EBAMCBaAwCgYIKoZIzj0EAwIDSAAwRQIgcRqHvybuL5WlAlNusu++a+cR1onTcj9VeH9ymNsFnQUCIQDfs95vijEGiXZEz2D8LF2umf1zBHvTo2s9u8EW92NypA==")
        static let ehnVaccinationCert = TestData(encodedEhnCert: "HC1:NCFD:MFY7N/Q.53VEEWRH7ATC3NY5F*DKNBV04E/IE/ZGM:MS1FA7RR4RA/4VDTTJPJ848DRR*S*:2GG90P2PL7THV$ZMDB8Q7EESNKT5X97G090R8 2DO$BK-R0245.VW.1D-J5OSCCU+ZNXSP42O% 4W*L28KKQ1WIPTDSE%FX:2J6O/LCW7V96DN%FTWD6.5BH5I+I2I9R+IPHK6 8FTCFXB$22CSOEPM:$VF M784PMB71OIWMMPALHBPCCYI5B.PK-P$CBXF5%S2WG6:3K.NJL$4P Q/YEEC7V24DQ3U 2TBA9XEB1D+JAP%5LOCLIAY 4HBD-UN3 PHXUEES:XJG/KHK67TM3H0ZK1MEERYA*B7F4MCLJK$9TMQPIA4%68DH GP+FGN%3KO8H5BH941MEN*9/OJHQG:K6S30B98Y63P P8OHOZKK$7IAS$Q8Z.8X0WCE6$J1UFJ56GBS8P-TUD9VN0SR2UPLLN9E469F0J.NNO4QT3240Q57F8C:TP1 M3DGRMSIWK7MRF9WC1S5RJ4 FT TGLV3WMK5I6MF+RGZ:NNQU9ARK2G7D7%+8I8S$2U7%INWK8RFW5ELQRMKTD6763D 1G-HOL$V*7HTN752E%O7:CFU.2WM365", keyId: "8TRqlBQxUbQ", encodedSigningCert: "MIIBIzCByqADAgECAgQbc6tlMAoGCCqGSM49BAMCMBAxDjAMBgNVBAMMBUVDLU1lMB4XDTIxMDQyMDA3Mjg1MVoXDTIxMDUyMDA3Mjg1MVowEDEOMAwGA1UEAwwFRUMtTWUwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASAnF9trnoiLJxV8zkWDCv4jM9/ls3bC5vVt/+oXkgHCOndb7e/7stg1OP64Gh3l/k64MlTBdR448bQA1IPXgOcoxIwEDAOBgNVHQ8BAf8EBAMCBaAwCgYIKoZIzj0EAwIDSAAwRQIgcRqHvybuL5WlAlNusu++a+cR1onTcj9VeH9ymNsFnQUCIQDfs95vijEGiXZEz2D8LF2umf1zBHvTo2s9u8EW92NypA==")
        static let ehnRecoveryCert = TestData(encodedEhnCert: "HC1:NCFOXN%TS3DH0ZS2F97O2RXO5Y5CIDDH4%%5OGI+MHY5EM*489A+OFKQCAQCCV4*XUT3PDJPO-OJX1H:O/B9/UIQRAFTQ2JATK2YJADG6JD3YW4:3TLD37UJBG7ME7ND33836:IOS0LS400T*OVN%2LXK6*K$X4%*4HBTSCNT 4C%C47T+*4.$S6ZC0JB7MBKD34LTAGJ%4JI$46S4:-KJC3HC3183N:2I$4J%59/9+T53ZM$96PZ6+Q6X46E/9M.5+NN4A7XHMDYPWGO%42E8QFW6DX7 N6HK8+GO5D6L*O/HQB+P *PUHPM+Q3IRL*O-+RWGO-*OWGOQ+QNR2UMO+00ZS2C9EH9WQ5QRYA/BWSZ8CBO77CT77WQL 2O/VC9N37/PKRBIVAU82NKLL5MZWQ X5V1OV6IWLE%:6CB7G%9JPFHMVDTFVFD8NEZLHIAVAA0JY7U5", keyId: "8TRqlBQxUbQ", encodedSigningCert: "MIIBIzCByqADAgECAgQbc6tlMAoGCCqGSM49BAMCMBAxDjAMBgNVBAMMBUVDLU1lMB4XDTIxMDQyMDA3Mjg1MVoXDTIxMDUyMDA3Mjg1MVowEDEOMAwGA1UEAwwFRUMtTWUwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASAnF9trnoiLJxV8zkWDCv4jM9/ls3bC5vVt/+oXkgHCOndb7e/7stg1OP64Gh3l/k64MlTBdR448bQA1IPXgOcoxIwEDAOBgNVHQ8BAf8EBAMCBaAwCgYIKoZIzj0EAwIDSAAwRQIgcRqHvybuL5WlAlNusu++a+cR1onTcj9VeH9ymNsFnQUCIQDfs95vijEGiXZEz2D8LF2umf1zBHvTo2s9u8EW92NypA==")
        
        static let ehnRsaSignedVaccinationCert = TestData(encodedEhnCert: "HC1:NCFOXNYTS3DHNXSO9WCVM86L+UQ*W5U 2HJ6ELBXG4KT266WTSJHK86%392PK7PAN9I6T/ZHBMIXLH7G3JRHRTI+*47ALF.KZ/KD-4$XKC%C%Q6NK9S P.Q6D%68%EDNEWW66G6.Q53C1B69GYPWRU1W5DB9.G9/G9VY95CQ-8EDS9%PP%.PZY9AKPCPP0%MS%MQW6%PQ5G6G%5 T9EKB%ZJRMI784W1J.ZJYIJ*8B.IJB8L+ZJY1BXZIG42$IJH7J*CL7TC TAKBI/8D:8DOVD7KDP9CJYJBKBQWT.+S1QDC8CO8CG8C3AD-ZJ9KB/VSQOL9DLKWCZ3EBKD.GILYJ7GPWZJZEBMEDTJCJKDLEDL9C.ZJU0C**UCKEJ/F%3M5II$2MSIJAUJX2M1GG8KE6JCW/I$DQ$CICO1BMIHSU1CJF4TZ-493IJ9GZSPL409FA5QNG+8X:802J9%IYQTHFTEP4N*KO1703L7:4A1LFBL$23V0H423JKB$IJY73%IJLD3:L3.43ERJ.43EAJ.43MOJ.F0D10/BQ 558JIH6M5DST.CU.VLB5ACCDWJ:VTYUM83L7TJM0PAZU*2WWQH$N1Z 7%:B6OC8WVN7N::UTXOUDOU%D8*7B$N6ENZQO6:4*Y5I5WI4NF GNP70LMD2RDN7L RAB2RWL NUE6P261GJ0LTT48S8+L$O676BFZV87MN6CRASSK12814TA5BJH%V3LT/VLOXQ7:8A1I%1J3AKWRG OGP UC/EU6IGO9VZFEMB VUC$9%:ONX3225*O50MNN SKMM/53E7MVI6YCSAKU+JUNI5DHRVQCYI7+B5L%V/M5X I+J8P1KX*IBUJORFND84UQ3AL+ 72$OB6G/7V2ED/NB7NVP7LEXUSTHOXG6OS-XV.QVLTH2WA XFR539-MFAESX2N9PD6OY$GZ$K16VETBUEF%FA$IDV00B7OV1", keyId: "wW_ZzXHLaWY", encodedSigningCert: "MIICszCCAZugAwIBAgIFAL2D8WQwDQYJKoZIhvcNAQELBQAwETEPMA0GA1UEAwwGUlNBLU1lMB4XDTIxMDQyMDA3Mjg1MloXDTIxMDUyMDA3Mjg1MlowETEPMA0GA1UEAwwGUlNBLU1lMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAh1M3pnkGw2SQTR+9scMOmCzoZo/lxnfTITYcvThNeO/iqBuvuq/m17B8laA7tWej2OGllkcyUEajiHm7t5JnDjE+bYyQaxzAJ2uLq+6E29/H7uqVnF9iQFLGqZBHkxXFAKnN4HXmbH3wZKBrY+JPWgMFtC4rHXmaWmBqOKBYz6VVYb68s1OO3t3CjliLiLZKVOOFOKUcXiXNoV16lP5QV+O8PWAFwH18+BZxp0sCfTblobVdRARHKdXstQZfp348q3YeCbbvntgCL0xn/XF9cZeeneHhTl4vD2IBrpjVjLEAZ+2rusR2PSg4UEM9UDhprV2+Tl5wC5gPd/iqv3j0+QIDAQABoxIwEDAOBgNVHQ8BAf8EBAMCBaAwDQYJKoZIhvcNAQELBQADggEBAH7Es0hJVNE7s6Fe7A9MgkXY1cvmkqaddCSTXeuRCq8GHXzPhAXzRcPkOvtkGRUxbCQznkMbUUGbHdpNA/LOAXhyVznPjffSpy+MxBttpx706dyovkS7NANpwk6MEr/oRjQGaDdvmH1wNtza1lbk451JZh2y17mV/kkxw4TH7IwNOSNgi5pGgwkMsVDViQAh4Uwcxih4SDAi9kmmaL65hDu7mEyPblVSdp7VjgwshBa1ybd0l6ezWqNibcGBG5JHjb2mkj31ZEL0n4VTyUd8BeKLjDi6tifibuWnsw2pxd6n+I1oPuJBJK+DGeIVsYEcjwKse3gaJpJ1ksS/Ic/OY7s=")
    }
    
    
    struct Failure {
        static let unprotectedAlgHeader = TestData(encodedEhnCert: "HC1:NCFI.L/8OAP29S2QINV25:T5M-BT8B*ZONTJDO6/UM5K5OHNNDUSB94%SJ$SJ%OEORLXC 1WO8UO 3SE4%KMM-MBZM7T6CKGI31TOPR4VYXD4CWVHHV21J-MTBHZ-E1QO:7SJ%V11GJCU*FRLEF2XQPAB/CNWEP:BSEZ2S*C9MTV%GNHFFBE:NEF7RR+N8TDA-RGLM5+K2NVR6QO HWUDNRRNPA:49S51B39Y:UEYAKLURNJT:5AQ8JNN0M21FH+1OHI4Q-21/QAMT0SEXBFCUNJ$CMDMHVISTTMEDESA6T0PNAF0QW/4INR$FGO*5QTK1SK-J8O.MG00X%3DDA1IKFM8KO1FT8.TGEU9+-2I-MYM0D$2NT8 H558J/LHPFJ7HM89R $64$1H-MG40 Z7C:G5SL7LOA0CCPO*%EPJE+M4NTCC93ZR85B2 :KECAGV1NDEB2D1DF84C:QPZOAP1IS621C8QFJ:BWP%A3GE9EL2LPVI6L$58JJ2+SDC2 *8WEQB:T.83N2WUS8O-FKKPT88:1K5KI812TAEH6CKVD46NLXRSGOQC4S+B1IM8O3H8OLVD*WDQW3$01EL7TPD.%6RZN:JBIQKYKBX5O-1WDEUV-JHFVOALV4CPOT$RBW%7C.J.MNZ-F- UNKNRSRGL56Y73ZF7AKAH6-9V9NO7JP*7T18S/+8NQV6ACHBE0SRW07JXVHY68$Q", keyId: "mgJOa1m_Qs4", encodedSigningCert: "MIIBJDCBy6ADAgECAgUA0+PgpTAKBggqhkjOPQQDAjAQMQ4wDAYDVQQDDAVFQy1NZTAeFw0yMTA0MTkxMjE3MjZaFw0yMTA1MTkxMjE3MjZaMBAxDjAMBgNVBAMMBUVDLU1lMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAENB9s11TMwMOV+a9R+cf5RYFzKxI/sYW7dL6Fl+1ZkXTdQjXx02r06ktxdVpHEO4x2rCKrylSVfrQYhS86Y2/wqMSMBAwDgYDVR0PAQH/BAQDAgWgMAoGCCqGSM49BAMCA0gAMEUCIEgCjXr/MDspRyEoQB+XKblF04aWmenffKwy/hHD/x6GAiEAzsGgImW/bh1CVN867if7GKYVqNAM6Pxaumgf+3rhv3A=")
    }
    
    let testDataString = """
[{"JSON":{"ver":"1.0.0","nam":{"fn":"Lövström","fnt":"LOEVSTROEM","gn":"Oscar","gnt":"OSCAR"},"dob":"1958-11-11","v":[{"tg":"840539006","vp":"J07BX03","mp":"EU/1/21/1529","ma":"ORG-100030215","dn":2,"sd":2,"dt":"2021-03-18","co":"SE","is":"Swedish eHealth Agency","ci":"urn:uvci:01:SE:EHM/100000024GI5HMGZKSMS"}]},"CBOR":"bf6376657265312e302e30636e616dbf62666e6a4cc3b676737472c3b66d63666e746a4c4f45565354524f454d62676e654f7363617263676e74654f53434152ff63646f626a313935382d31312d3131617681bf62746769383430353339303036627670674a303742583033626d706c45552f312f32312f31353239626d616d4f52472d31303030333032313562646e02627364026264746a323032312d30332d313862636f625345626973765377656469736820654865616c7468204167656e6379626369782775726e3a757663693a30313a53453a45484d2f313030303030303234474935484d475a4b534d53ffff","COSE":"d2844da2012604486f43c4d54f045e5ca0590104a401625345041a610856eb061a6091afeb390103a101a4617681aa626369782775726e3a757663693a30313a53453a45484d2f313030303030303234474935484d475a4b534d5362636f62534562646e026264746a323032312d30332d3138626973765377656469736820654865616c7468204167656e6379626d616d4f52472d313030303330323135626d706c45552f312f32312f313532396273640262746769383430353339303036627670674a30374258303363646f626a313935382d31312d3131636e616da462666e6a4cc3b676737472c3b66d62676e654f7363617263666e746a4c4f45565354524f454d63676e74654f534341526376657265312e302e305840f9e5fc40eb84b40b4869da430f18f4ec3d0b01645a3920a136b3fa3b8ebb8093f73b39e82087656eec19c67dd09cd888380549e097863a6f97575dbe39a67add","BASE45":"NCFOXN%TSMAHN-H3O4:PVH AJ2J$9J0II:Q5 43SLG/EBUD2XPO.TM8W42YBJSRQHIZC4.OI1RM8ZA*LPUY29+KCFF-+K*LPH*AA:G$LO5/A+*39UVC 0G8C:USOHDAPSY+3AZ33M3JZIM-1Z.4UX4795L*KDYPWGO+9AAEOXCRFE4IWMIT5NR7LY4357LC4DK4LC6DQ42JO9X7M16GF6:/6N9R%EP3/28MJE9A7EDA.D90I/EL6KKLIIL4OTJLI C3DE0OA0D9E2LBHHGKLO-K%FGLIA-D8+6JDJN XGHFEZI9$JAQJKHJLK3M484SZ4RZ4E%5MK9AZPKD70/LIFN7KTC5NI%KH NVFWJ-SUQK8%MPLI8:31CRNHS*44+4BM.SY$NOXAJ8CTAP1-ST*QGTA4W7.Y7N31D6K-BW/ N NRM1U*HFNHJ9USSK380E%WISO9+%GRTJ GBW0UEFJ42SUTU9I8/MD3N3ARC/03W-RHDMO1VC767.P95G-CFA.7L C02FM8F6UF","PREFIX":"HC1:NCFOXN%TSMAHN-H3O4:PVH AJ2J$9J0II:Q5 43SLG/EBUD2XPO.TM8W42YBJSRQHIZC4.OI1RM8ZA*LPUY29+KCFF-+K*LPH*AA:G$LO5/A+*39UVC 0G8C:USOHDAPSY+3AZ33M3JZIM-1Z.4UX4795L*KDYPWGO+9AAEOXCRFE4IWMIT5NR7LY4357LC4DK4LC6DQ42JO9X7M16GF6:/6N9R%EP3/28MJE9A7EDA.D90I/EL6KKLIIL4OTJLI C3DE0OA0D9E2LBHHGKLO-K%FGLIA-D8+6JDJN XGHFEZI9$JAQJKHJLK3M484SZ4RZ4E%5MK9AZPKD70/LIFN7KTC5NI%KH NVFWJ-SUQK8%MPLI8:31CRNHS*44+4BM.SY$NOXAJ8CTAP1-ST*QGTA4W7.Y7N31D6K-BW/ N NRM1U*HFNHJ9USSK380E%WISO9+%GRTJ GBW0UEFJ42SUTU9I8/MD3N3ARC/03W-RHDMO1VC767.P95G-CFA.7L C02FM8F6UF","2DCODE":"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","TESTCTX":{"VERSION":1,"SCHEMA":"1.0.0","CERTIFICATE":"MIIBYDCCAQagAwIBAgIEYGIVCzAKBggqhkjOPQQDAjA4MQswCQYDVQQGEwJTRTENMAsGA1UECgwERElHRzEaMBgGA1UEAwwRSENlcnQgU2lnbmVyIFRlc3QwHhcNMjEwMzI5MTc1NzMxWhcNMjIwMzI5MTc1NzMxWjA4MQswCQYDVQQGEwJTRTENMAsGA1UECgwERElHRzEaMBgGA1UEAwwRSENlcnQgU2lnbmVyIFRlc3QwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQXNY8VvikJck41yqTP4ywegcKsTDsVMWlHAOPvDfzQs+n1T/912la9SQw4rzzyYHqoC+I+WVwwkkVcDOijb6B+MAoGCCqGSM49BAMCA0gAMEUCIQCgsGcnfxQGqhuX9DbmDEFS/xGW8P/Us25sRxvTkWiJIgIgFpzdl/IxggUOGe1v+/bI6hn43noNU4Y0f5zBEc+pBdI=","VALIDATIONCLOCK":"2021-05-05T20:34:51.085231Z","DESCRIPTION":"1: One vaccination entry - Everything should verify fine"},"EXPECTEDRESULTS":{"EXPECTEDSCHEMAVALIDATION":true,"EXPECTEDENCODE":true,"EXPECTEDDECODE":true,"EXPECTEDVERIFY":true,"EXPECTEDUNPREFIX":true,"EXPECTEDVALIDJSON":true,"EXPECTEDB45DECODE":true,"EXPECTEDPICTUREDECODE":true,"EXPECTEDEXPIRATIONCHECK":true}},
{
    "JSON": {
        "ver": "1.0.0",
        "nam": {
            "fn": "Musterfrau-Gößinger",
            "fnt": "MUSTERFRAU<GOESSINGER",
            "gn": "Gabriele",
            "gnt": "GABRIELE"
        },
        "dob": "1998-02-26",
        "v": [
            {
                "tg": "840539006",
                "vp": "1119305005",
                "mp": "EU/1/20/1528",
                "ma": "ORG-100030215",
                "dn": 1,
                "sd": 2,
                "dt": "2021-02-18",
                "co": "AT",
                "is": "BMSGPK Austria",
                "ci": "urn:uvci:01:AT:10807843F94AEE0EE5093FBC254BD813P"
            }
        ]
    },
    "CBOR": "a4041a6092dd20061a60903a2001624154390103a101a4617681aa62646e01626d616d4f52472d3130303033303231356276706a313131393330353030356264746a323032312d30322d313862636f624154626369783075726e3a757663693a30313a41543a313038303738343346393441454530454535303933464243323534424438313350626d706c45552f312f32302f313532386269736e424d5347504b20417573747269616273640262746769383430353339303036636e616da463666e74754d5553544552465241553c474f455353494e47455262666e754d7573746572667261752d47c3b6c39f696e67657263676e74684741425249454c4562676e684761627269656c656376657265312e302e3063646f626a313939382d30322d3236",
    "COSE": "d2844da20448e9175b10e19062c10126a0590124a4041a6092dd20061a60903a2001624154390103a101a4617681aa62646e01626d616d4f52472d3130303033303231356276706a313131393330353030356264746a323032312d30322d313862636f624154626369783075726e3a757663693a30313a41543a313038303738343346393441454530454535303933464243323534424438313350626d706c45552f312f32302f313532386269736e424d5347504b20417573747269616273640262746769383430353339303036636e616da463666e74754d5553544552465241553c474f455353494e47455262666e754d7573746572667261752d47c3b6c39f696e67657263676e74684741425249454c4562676e684761627269656c656376657265312e302e3063646f626a313939382d30322d32365840d919206937b3e707217bf42be726ea6ac4f90e2d4eb80e9a7aa6e2eae57148b2606f92a6e8bc852f05777f4b5e755e57776f406d1725e02f03613fd489545e14",
    "COMPRESSED": "78da158f3b4bc350184089cfad3808a25305759198ef268d2641d0546fa3d4da92b6a808a5b969daa6985b4d932a3a88a0839b7474f141e9e0a8200e2e527f81b838082a888fd9c5cdba1e3807cec37eecbc63eeab6fb5e7f588dc3123a72bcc50bd63205b7b0e760d648f942043d494ccb49f3175a3ba77417294218ee1c4758d450020008f44525d2f21846401440091e4bc12dfc22cf02c9288596e0588696f81ef52c5af9ab6024851530a020926a4901091432ac680b108b21009cff062283c2b2121419cf5359ce610c70387445e2276858663492d110daa7ec5736d8354726dc42bd852084441061837a9e1d4cd3cf5fc583a99c27a4457d3935a1c2793f38b1ad6499efab1966ab979d7f059ad79dd3cb169c172cd02f58a9a1ad6e7f10226055ad40ce2dad69a65562dd74263300666ae4c4a4896a5ff2f7e7c79faa93f684f5c7d740feefc8c7e8c7c97ee7f03ece24de078bbf1f6fdbe3177992dd71a9fb7075ce7e66e34e3679636cbd34edff00bd76e4c3d1ea632bd7fde9180ad",
    "BASE45": "NCFTW2EM75VO/23:IHJ+L541DMA$%E1FJE*4S$47FQ45E++QSOI-ALZ.K8HDX2LIOB9RI:H76DKGTJCZE/E82ISG24N%5G5G0DNK11*BH*NRG0Q- 3I:06WOY-TMSCCUL$:M 1VT$R$M47O5E9A-NCJPBC$18V1 6IO34F*QO*PS5KA*EZPNEC8VWI$2IS$OU%HW00830US85ZBUA4-SC%Q8/JI-YN.CSTU5PS5UAH++D1BHF4ELBUR:O6PJ:C0TCA.B12718 KB424M8B4P5HM:MM A1NHU+35GK5894-$J:Y6 3T77PN4HN+BB:EN:GDB9072-OLC/O0%DIUAK*DJO5UGADS8UY0T17WOSP.PH4V-6BWJJPKFS4BCSI7P3UVIFQH24RI4KCKM6MD6IFEHU*-LQ/RCJMMKOC-P%1VULJP7R3LUD 4WLBDS1.TRFNJB+AQ9RCOCI 0P1MQH902JWBWP:F-IF$HLI8D7VBBUEP9UBYH9YHE9JP2GR.T1%9$BFMQUN3WIB6IGJV8RR8K*-0BET.-DUXSO:IOYPV/9QFUPARWS9G*3TI6J7GXHI%3",
    "PREFIX": "HC1:NCFTW2EM75VO/23:IHJ+L541DMA$%E1FJE*4S$47FQ45E++QSOI-ALZ.K8HDX2LIOB9RI:H76DKGTJCZE/E82ISG24N%5G5G0DNK11*BH*NRG0Q- 3I:06WOY-TMSCCUL$:M 1VT$R$M47O5E9A-NCJPBC$18V1 6IO34F*QO*PS5KA*EZPNEC8VWI$2IS$OU%HW00830US85ZBUA4-SC%Q8/JI-YN.CSTU5PS5UAH++D1BHF4ELBUR:O6PJ:C0TCA.B12718 KB424M8B4P5HM:MM A1NHU+35GK5894-$J:Y6 3T77PN4HN+BB:EN:GDB9072-OLC/O0%DIUAK*DJO5UGADS8UY0T17WOSP.PH4V-6BWJJPKFS4BCSI7P3UVIFQH24RI4KCKM6MD6IFEHU*-LQ/RCJMMKOC-P%1VULJP7R3LUD 4WLBDS1.TRFNJB+AQ9RCOCI 0P1MQH902JWBWP:F-IF$HLI8D7VBBUEP9UBYH9YHE9JP2GR.T1%9$BFMQUN3WIB6IGJV8RR8K*-0BET.-DUXSO:IOYPV/9QFUPARWS9G*3TI6J7GXHI%3",
    "2DCODE": "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",
    "TESTCTX": {
        "VERSION": 1,
        "SCHEMA": "1.0.0",
        "CERTIFICATE": "MIIBVzCB/6ADAgECAgQHuENOMAoGCCqGSM49BAMCMBAxDjAMBgNVBAMMBUVDLU1lMB4XDTIxMDUwMzE4MDAwMFoXDTIxMDYwMjE4MDAwMFowEDEOMAwGA1UEAwwFRUMtTWUwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATnp4j3drXexlpxi8L6AktBXAJUnI/GKInqlE0VlfZshKBTn7jww52KbtVDCRCYXXatlGpktAsEn9490HtaAR1Po0cwRTAOBgNVHQ8BAf8EBAMCBaAwMwYDVR0lBCwwKgYMKwYBBAEAjjePZQEBBgwrBgEEAQCON49lAQIGDCsGAQQBAI43j2UBAzAKBggqhkjOPQQDAgNHADBEAiAt0NLuuFi/SQPT69x/cfvfXqd1FNmTon0Yb3FD9fPsYAIgVxwNY1YOLc4H0rEv6iIWLGLaGXEwElN8Lw9rZ1UgQMM=",
        "VALIDATIONCLOCK": "2021-05-03T20:00:00+02:00",
        "DESCRIPTION": "VALID: AT: Vaccination"
    },
    "EXPECTEDRESULTS": {
        "EXPECTEDVALIDOBJECT": true,
        "EXPECTEDSCHEMAVALIDATION": true,
        "EXPECTEDDECODE": true,
        "EXPECTEDVERIFY": true,
        "EXPECTEDUNPREFIX": true,
        "EXPECTEDVALIDJSON": true,
        "EXPECTEDCOMPRESSION": true,
        "EXPECTEDB45DECODE": true,
        "EXPECTEDPICTUREDECODE": true
    }
},
{
    "JSON": {
        "ver": "1.0.0",
        "nam": {
            "fn": "Musterfrau-Gößinger",
            "fnt": "MUSTERFRAU<GOESSINGER",
            "gn": "Gabriele",
            "gnt": "GABRIELE"
        },
        "dob": "1998-02-26",
        "r": [
            {
                "tg": "840539006",
                "fr": "2021-02-20",
                "co": "AT",
                "is": "BMSGPK Austria",
                "df": "2021-04-04",
                "du": "2021-10-04",
                "ci": "urn:uvci:01:AT:858CC18CFCF5965EF82F60E493349AA5Y"
            }
        ]
    },
    "CBOR": "a4041a6092dd20061a60903a2001624154390103a101a4617281a76264756a323032312d31302d303462636f624154626369783075726e3a757663693a30313a41543a3835384343313843464346353936354546383246363045343933333439414135596269736e424d5347504b2041757374726961627467693834303533393030366266726a323032312d30322d32306264666a323032312d30342d3034636e616da463666e74754d5553544552465241553c474f455353494e47455262666e754d7573746572667261752d47c3b6c39f696e67657263676e74684741425249454c4562676e684761627269656c656376657265312e302e3063646f626a313939382d30322d3236",
    "COSE": "d2844da20448d919375fc1e7b6b20126a0590109a4041a6092dd20061a60903a2001624154390103a101a4617281a76264756a323032312d31302d303462636f624154626369783075726e3a757663693a30313a41543a3835384343313843464346353936354546383246363045343933333439414135596269736e424d5347504b2041757374726961627467693834303533393030366266726a323032312d30322d32306264666a323032312d30342d3034636e616da463666e74754d5553544552465241553c474f455353494e47455262666e754d7573746572667261752d47c3b6c39f696e67657263676e74684741425249454c4562676e684761627269656c656376657265312e302e3063646f626a313939382d30322d323658405f1feb13abe5dd8db51704b67e94aa5daef5b11934fa8deec49822c3a512c2287fbf982a97fc7f440f10a0da14ae7850606d8f3cb2653bf1bc4e0c9fef911b74",
    "COMPRESSED": "78dabbd4e2bb88c5e3a6a479fcc1e7db3631aa2d8864e45cc2229530e9ae029b54c2042b05c624c7104b46e6858c4b128b1a9727a5946619191819ea1a1ae81a982425e703659392332b0c4a8bf2ac4acb9233ad0c0cad1c43ac2c4c2d9c9d0d2d9cdd9cdd4c2dcd4c5ddd2c8cdccc0c5c4d2c8d8d4d2c1d1d4d2393328bf39c7c83dd03bc151c4b8b4b8a3213934ad2332d4c0c4c8d2d0d0ccc92d28a20f61818e91a1924a5a441792640949c9798bb24392dafa4d4373438c435c82dc831d4c6dddf3538d8d3cfdd3528292dafd41768646a515a5162a9aefbe16d87e767e6a5a71625a7e79564b83b3a0579bafab826a5e765b827261565a6e6a42697a516a51aea19e81924a7e42765195a5a5a80ed358b7088977f2dbcfae9dddeade22cdbeaa6ac8a5df775a3a4c9afde774766281d5e2a7448a37eff0cade97fea5df80516dc125957119090db6fb329d5fae31e3f9ef9ef274a9700000e7c7c9d",
    "BASE45": "NCFOXN%TS3DH3ZSUZK+.V0ETD%65NL-AH5*SIOOW%IHOT$E08WAWN0%W0AT4V22F/8X*G3M9FQH+4J/-K$+CY73JC3MD3IFTNAJSZ4EJ0NTI4L6-O16VH6ZL4XP:N6ON1 *L:O80R5LY5K%JLY5W0S./RPZ5JT9A/RF H ZP4UBKS5%%H/P5VV3HM4OH6*ZUFXFE.R:YN/P3JRH8LHGL2TK96L6SR9MU9DV5 R1BPIZKH05VW63LD3LS4JYK9EFH78$ZJ*DJ3Q4+Y5V$K2:6.77/Z6KZ5LD6E6P 9SH87/YQJ/RL35+Y5P Q*8D$JD IBCLCK5MJMS68H36DH.K:Z28AL**I3DN3F7MHFEVV%*4HBTSCNT 4C%C47TO*47*KB*KYQTHFTNS4.$S6ZC0JB%JBK:TBSH2CHM3G3+NJPTZ6SUQS3 R83L6MHYCV.UKGMPQ5S819935V+BNVE4UK.AWG:LV7GQ*B.S0/ RBDB-923EIK5E:C5CWV3$3H4KNAUFJ9000I$1-XF",
    "PREFIX": "HC1:NCFOXN%TS3DH3ZSUZK+.V0ETD%65NL-AH5*SIOOW%IHOT$E08WAWN0%W0AT4V22F/8X*G3M9FQH+4J/-K$+CY73JC3MD3IFTNAJSZ4EJ0NTI4L6-O16VH6ZL4XP:N6ON1 *L:O80R5LY5K%JLY5W0S./RPZ5JT9A/RF H ZP4UBKS5%%H/P5VV3HM4OH6*ZUFXFE.R:YN/P3JRH8LHGL2TK96L6SR9MU9DV5 R1BPIZKH05VW63LD3LS4JYK9EFH78$ZJ*DJ3Q4+Y5V$K2:6.77/Z6KZ5LD6E6P 9SH87/YQJ/RL35+Y5P Q*8D$JD IBCLCK5MJMS68H36DH.K:Z28AL**I3DN3F7MHFEVV%*4HBTSCNT 4C%C47TO*47*KB*KYQTHFTNS4.$S6ZC0JB%JBK:TBSH2CHM3G3+NJPTZ6SUQS3 R83L6MHYCV.UKGMPQ5S819935V+BNVE4UK.AWG:LV7GQ*B.S0/ RBDB-923EIK5E:C5CWV3$3H4KNAUFJ9000I$1-XF",
    "2DCODE": "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",
    "TESTCTX": {
        "VERSION": 1,
        "SCHEMA": "1.0.0",
        "CERTIFICATE": "MIIBvTCCAWOgAwIBAgIKAXk8i88OleLsuTAKBggqhkjOPQQDAjA2MRYwFAYDVQQDDA1BVCBER0MgQ1NDQSAxMQswCQYDVQQGEwJBVDEPMA0GA1UECgwGQk1TR1BLMB4XDTIxMDUwNTEyNDEwNloXDTIzMDUwNTEyNDEwNlowPTERMA8GA1UEAwwIQVQgRFNDIDExCzAJBgNVBAYTAkFUMQ8wDQYDVQQKDAZCTVNHUEsxCjAIBgNVBAUTATEwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASt1Vz1rRuW1HqObUE9MDe7RzIk1gq4XW5GTyHuHTj5cFEn2Rge37+hINfCZZcozpwQKdyaporPUP1TE7UWl0F3o1IwUDAOBgNVHQ8BAf8EBAMCB4AwHQYDVR0OBBYEFO49y1ISb6cvXshLcp8UUp9VoGLQMB8GA1UdIwQYMBaAFP7JKEOflGEvef2iMdtopsetwGGeMAoGCCqGSM49BAMCA0gAMEUCIQDG2opotWG8tJXN84ZZqT6wUBz9KF8D+z9NukYvnUEQ3QIgdBLFSTSiDt0UJaDF6St2bkUQuVHW6fQbONd731/M4nc=",
        "VALIDATIONCLOCK": "2021-05-03T20:00:00+02:00",
        "DESCRIPTION": "VALID: AT: Recovery"
    },
    "EXPECTEDRESULTS": {
        "EXPECTEDVALIDOBJECT": true,
        "EXPECTEDSCHEMAVALIDATION": true,
        "EXPECTEDDECODE": true,
        "EXPECTEDVERIFY": true,
        "EXPECTEDUNPREFIX": true,
        "EXPECTEDVALIDJSON": true,
        "EXPECTEDCOMPRESSION": true,
        "EXPECTEDB45DECODE": true,
        "EXPECTEDPICTUREDECODE": true
    }
},
{
    "JSON": {
        "ver": "1.0.0",
        "nam": {
            "fn": "Musterfrau-Gößinger",
            "fnt": "MUSTERFRAU<GOESSINGER",
            "gn": "Gabriele",
            "gnt": "GABRIELE"
        },
        "dob": "1998-02-26",
        "t": [
            {
                "tg": "840539006",
                "tt": "LP6464-4",
                "nm": "Roche LightCycler qPCR",
                "sc": "2021-02-20T12:34:56Z",
                "dr": "2021-02-20T14:56:01Z",
                "tr": "260415000",
                "tc": "Testing center Vienna 1",
                "co": "AT",
                "is": "BMSGPK Austria",
                "ci": "urn:uvci:01:AT:B5921A35D6A0D696421B3E24621782971"
            }
        ]
    },
    "CBOR": "a4041a6092dd20061a60903a2001624154390103a101a4617481aa6273631b00000177bf6f91806264721b00000177bff0bbe8627474684c50363436342d34626e6d76526f636865204c696768744379636c657220715043526274637754657374696e672063656e746572205669656e6e61203162636f624154626369783075726e3a757663693a30313a41543a4235393231413335443641304436393634323142334532343632313738323937316269736e424d5347504b20417573747269616274676938343035333930303662747269323630343135303030636e616da463666e74754d5553544552465241553c474f455353494e47455262666e754d7573746572667261752d47c3b6c39f696e67657263676e74684741425249454c4562676e684761627269656c656376657265312e302e3063646f626a313939382d30322d3236",
    "COSE": "d2844da20448d919375fc1e7b6b20126a0590145a4041a6092dd20061a60903a2001624154390103a101a4617481aa6273631b00000177bf6f91806264721b00000177bff0bbe8627474684c50363436342d34626e6d76526f636865204c696768744379636c657220715043526274637754657374696e672063656e746572205669656e6e61203162636f624154626369783075726e3a757663693a30313a41543a4235393231413335443641304436393634323142334532343632313738323937316269736e424d5347504b20417573747269616274676938343035333930303662747269323630343135303030636e616da463666e74754d5553544552465241553c474f455353494e47455262666e754d7573746572667261752d47c3b6c39f696e67657263676e74684741425249454c4562676e684761627269656c656376657265312e302e3063646f626a313939382d30322d323658405cbe5c32582d4d4cb774fbd954f5efee7eae17fb29908819e03eceb9942269a656fbfd136904c8510cc30be68419a538db36584b3cea8b4c20ef9134905aa693",
    "COMPRESSED": "78dabbd4e2bb88c5e3a6a479fcc1e7db3631aa2d8864745dc2229530e9ae029b54c2042b05c624c7104b46e6858c4b124b1a572515274b33303096efcf9fd890945204617fd8fd22a9a424c327c0ccc4cc44d724292fb72c283f392355c127333da3c4b9323927b548a130c03928a924b93c24b5b824332f5d213935af04281c96999a9797a86098949c0fb4282939b3c2a0b428cfaab42c39d3cac0d0ca31c4cac9d4d2c8d0d1d8d4c5ccd1c0c5ccd2ccc4c8d0c9d8d5c8c4ccc8d0dcc2c8d2dc3029b338cfc937d83dc05bc1b1b4b8a4283331a9243dd3c2c4c0d4d8d2c0c02c09286264666062686a6060909c9798bb24392dafa4d4373438c435c82dc831d4c6dddf3538d8d3cfdd3528292dafd41768466a515a5162a9aefbe16d87e7031d9b5a949c9e5792e1eee814e4e9eae39a949e97e19e985494999a939a5c965a946aa867a067909c929f9465686969a16b60a46b6416e110b32fc62842d7d7677bc9ef9b215fdfbfab5b27fe5b734287e403bb733ba728652e0bfbfd573893e54420cf61ee672d924b2d6e9b4578dbbceaf651783fd16442d4b2c900b3719501",
    "BASE45": "NCFOXN%TS3DH3ZSUZK+.V0ETD%65NL-AH:VEIOOW%IHOT$E08WAWN0%W0AT4V22F/8X*G3M9BM9Y0BFU2 M9646T3J6BQ0HRZXI-O0D7G20W3KL6T4615+*P2$P-8RD9527N/352A7%$A0/4TZ76*OWF6+05889F767A7AHLZIN$S4PCN8L6 YBKA7T5M835X1JKOJY7JN9CJZIF:1L35BD79RO+YMHBQ:YM/D7JSPZHQ5D6SSPW+QIHPZNQJ+Q8+PTGO9+P+*PIHPCNP81RP*OIHP*+RKHPS$RAC5887VJP7FRDEO+LO4%M*XKAL6AHLW 70SO:GOLIROGONP5X457VCE8C09DC8CUCII7JSTNCA799MC$Q3R69 OZDP*DPK+Q92SYW6MIRNCQIW6B95CAM7/2Q+8 CA:CADKL-$V4%D99TJX3DKB:ZJ83BDPSCFTB.SBVTHOJ92KNNSQBJGZIGOJ6NJF0JEYI1DLNCKUCI5OI9YI:8D-FD%PDGZKHTCGKSGTMD2PBK8IAR9TF4DU%94*CS$TLN25BPBLI86$SHVNGO7 45. 5O%V81BGVIPR8Y9QB6UBY5UM9A:D9Z82ZRUVTLDA238GUC0+QLIP$UMU$I",
    "PREFIX": "HC1:NCFOXN%TS3DH3ZSUZK+.V0ETD%65NL-AH:VEIOOW%IHOT$E08WAWN0%W0AT4V22F/8X*G3M9BM9Y0BFU2 M9646T3J6BQ0HRZXI-O0D7G20W3KL6T4615+*P2$P-8RD9527N/352A7%$A0/4TZ76*OWF6+05889F767A7AHLZIN$S4PCN8L6 YBKA7T5M835X1JKOJY7JN9CJZIF:1L35BD79RO+YMHBQ:YM/D7JSPZHQ5D6SSPW+QIHPZNQJ+Q8+PTGO9+P+*PIHPCNP81RP*OIHP*+RKHPS$RAC5887VJP7FRDEO+LO4%M*XKAL6AHLW 70SO:GOLIROGONP5X457VCE8C09DC8CUCII7JSTNCA799MC$Q3R69 OZDP*DPK+Q92SYW6MIRNCQIW6B95CAM7/2Q+8 CA:CADKL-$V4%D99TJX3DKB:ZJ83BDPSCFTB.SBVTHOJ92KNNSQBJGZIGOJ6NJF0JEYI1DLNCKUCI5OI9YI:8D-FD%PDGZKHTCGKSGTMD2PBK8IAR9TF4DU%94*CS$TLN25BPBLI86$SHVNGO7 45. 5O%V81BGVIPR8Y9QB6UBY5UM9A:D9Z82ZRUVTLDA238GUC0+QLIP$UMU$I",
    "2DCODE": "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",
    "TESTCTX": {
        "VERSION": 1,
        "SCHEMA": "1.0.0",
        "CERTIFICATE": "MIIBvTCCAWOgAwIBAgIKAXk8i88OleLsuTAKBggqhkjOPQQDAjA2MRYwFAYDVQQDDA1BVCBER0MgQ1NDQSAxMQswCQYDVQQGEwJBVDEPMA0GA1UECgwGQk1TR1BLMB4XDTIxMDUwNTEyNDEwNloXDTIzMDUwNTEyNDEwNlowPTERMA8GA1UEAwwIQVQgRFNDIDExCzAJBgNVBAYTAkFUMQ8wDQYDVQQKDAZCTVNHUEsxCjAIBgNVBAUTATEwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASt1Vz1rRuW1HqObUE9MDe7RzIk1gq4XW5GTyHuHTj5cFEn2Rge37+hINfCZZcozpwQKdyaporPUP1TE7UWl0F3o1IwUDAOBgNVHQ8BAf8EBAMCB4AwHQYDVR0OBBYEFO49y1ISb6cvXshLcp8UUp9VoGLQMB8GA1UdIwQYMBaAFP7JKEOflGEvef2iMdtopsetwGGeMAoGCCqGSM49BAMCA0gAMEUCIQDG2opotWG8tJXN84ZZqT6wUBz9KF8D+z9NukYvnUEQ3QIgdBLFSTSiDt0UJaDF6St2bkUQuVHW6fQbONd731/M4nc=",
        "VALIDATIONCLOCK": "2021-05-03T20:00:00+02:00",
        "DESCRIPTION": "VAlID: AT: NAA Test"
    },
    "EXPECTEDRESULTS": {
        "EXPECTEDVALIDOBJECT": true,
        "EXPECTEDSCHEMAVALIDATION": true,
        "EXPECTEDDECODE": true,
        "EXPECTEDVERIFY": true,
        "EXPECTEDUNPREFIX": true,
        "EXPECTEDVALIDJSON": true,
        "EXPECTEDCOMPRESSION": true,
        "EXPECTEDB45DECODE": true,
        "EXPECTEDPICTUREDECODE": true
    }
},{
    "JSON": {
        "ver": "1.0.0",
        "nam": {
            "fn": "Musterfrau-Gößinger",
            "fnt": "MUSTERFRAU<GOESSINGER",
            "gn": "Gabriele",
            "gnt": "GABRIELE"
        },
        "dob": "1998-02-26",
        "t": [
            {
                "tg": "840539006",
                "tt": "LP6464-4",
                "ma": "1232",
                "sc": "2021-02-20T12:34:56Z",
                "dr": "2021-02-20T12:45:01Z",
                "tr": "260415000",
                "tc": "Testing center Vienna 1",
                "co": "AT",
                "is": "BMSGPK Austria",
                "ci": "urn:uvci:01:AT:71EE2559DE38C6BF7304FB65A1A451ECE"
            }
        ]
    },
    "CBOR": "a4041a6092dd20061a60903a2001624154390103a101a4617481aa6273631b00000177bf6f9180626d6164313233326264721b00000177bf78ccc8627474684c50363436342d346274637754657374696e672063656e746572205669656e6e61203162636f624154626369783075726e3a757663693a30313a41543a3731454532353539444533384336424637333034464236354131413435314543456269736e424d5347504b20417573747269616274676938343035333930303662747269323630343135303030636e616da463666e74754d5553544552465241553c474f455353494e47455262666e754d7573746572667261752d47c3b6c39f696e67657263676e74684741425249454c4562676e684761627269656c656376657265312e302e3063646f626a313939382d30322d3236",
    "COSE": "d2844da20448d919375fc1e7b6b20126a0590133a4041a6092dd20061a60903a2001624154390103a101a4617481aa6273631b00000177bf6f9180626d6164313233326264721b00000177bf78ccc8627474684c50363436342d346274637754657374696e672063656e746572205669656e6e61203162636f624154626369783075726e3a757663693a30313a41543a3731454532353539444533384336424637333034464236354131413435314543456269736e424d5347504b20417573747269616274676938343035333930303662747269323630343135303030636e616da463666e74754d5553544552465241553c474f455353494e47455262666e754d7573746572667261752d47c3b6c39f696e67657263676e74684741425249454c4562676e684761627269656c656376657265312e302e3063646f626a313939382d30322d32365840f398eafd9c0cef5234c09e8df3443481f0f76b16bec930df7347852c140e57d23371c9b12a7d14510e5bf6a341d152e0b8f9b0b9992ce210ef0d2bd9b1473fa2",
    "COMPRESSED": "78dabbd4e2bb88c5e3a6a479fcc1e7db3631aa2d8864345ec2229530e9ae029b54c2042b05c624c7104b46e6858c4b124b1a572515274b33303096efcf9fd890949b986268646c9494520411ab387322a9a424c327c0ccc4cc44d724a924b93c24b5b824332f5d213935af24b548212c33352f2f51c13029391f686c527266854169519e55695972a69581a195638895b9a1abab91a9a9a58babb185b399939bb9b181899b9399a9a3a1a389a9a1abb36b5266719e936fb07b80b7826369714951666252497aa6858981a9b1a58181591250c4c8ccc0c4d0d4c0c020392f317749725a5e49a96f6870886b905b9063a88dbbbf6b70b0a79fbb6b50525a5ea92fd08cd4a2b4a2c4525df7c3db0ecf073a36b528393daf24c3ddd129c8d3d5c735293d2fc33d31a92833352735b92cb528d550cf40cf2039253f29cbd0d2d242d7c048d7c82cc2e1f38c577fe7f0bc0f323930aff7b38b49e387efd962fb4e1adc2f766fd511e10bbf645c7872a356ad48205ff4b7c58e17831eecf8b961e74c9d4702ef79b56f6e74b75f040075828f23",
    "BASE45": "NCFOXN%TS3DH3ZSUZK+.V0ETD%65NL-AH-R6IOOW%IHOT$E08WAWN0%W0AT4V22F/8X*G3M9BM9Y0BFU2 M9646T3J6BQ0HRIZI+BJ*8DVWDZXI6N02TL:OE3KL6T4615+*P2$P-8RAHLZIN$S4PCN8L6 YBKA7G6MD-MW84EL6J/54FA:36/9729D1JAA/C5C8EEA+ZA%DBU2LKHG%*I0CH1LNRVLTII4KLPTH+JMWVMWTIHLN-GG2UJ7JJ*UKFUK0KLZVLOPDZ.C52KH5EQRF/8NOPCLEE3DAFJC0D9E2LBHHGKLO-K%FG8E2L*O *PT*OE+Q:COEA7IB6$C94JB2E9Z3E8AE-QD+PB.QCD-H/8O3BEQ8L9VN.6A4JBLHLIGQT*QR$M% OP*B9YOB*15-0A-6$35-Z76T4+1SVC54ZQC8PR95W165X7EHLEL62/4JINQ+MN/Q19QE8Q4A7E:7LYPFTQBK8*DOPCRST5IPSHXHS7GNJUK-1FA72BMIVMFF9E8HULRTYV H300696EWB2$L1.UC9AF9TKZ+L7447.U*/OY/2-+3/JV/GC%U9//8FCU7.MG/D88NYM0M%ED4I",
    "PREFIX": "HC1:NCFOXN%TS3DH3ZSUZK+.V0ETD%65NL-AH-R6IOOW%IHOT$E08WAWN0%W0AT4V22F/8X*G3M9BM9Y0BFU2 M9646T3J6BQ0HRIZI+BJ*8DVWDZXI6N02TL:OE3KL6T4615+*P2$P-8RAHLZIN$S4PCN8L6 YBKA7G6MD-MW84EL6J/54FA:36/9729D1JAA/C5C8EEA+ZA%DBU2LKHG%*I0CH1LNRVLTII4KLPTH+JMWVMWTIHLN-GG2UJ7JJ*UKFUK0KLZVLOPDZ.C52KH5EQRF/8NOPCLEE3DAFJC0D9E2LBHHGKLO-K%FG8E2L*O *PT*OE+Q:COEA7IB6$C94JB2E9Z3E8AE-QD+PB.QCD-H/8O3BEQ8L9VN.6A4JBLHLIGQT*QR$M% OP*B9YOB*15-0A-6$35-Z76T4+1SVC54ZQC8PR95W165X7EHLEL62/4JINQ+MN/Q19QE8Q4A7E:7LYPFTQBK8*DOPCRST5IPSHXHS7GNJUK-1FA72BMIVMFF9E8HULRTYV H300696EWB2$L1.UC9AF9TKZ+L7447.U*/OY/2-+3/JV/GC%U9//8FCU7.MG/D88NYM0M%ED4I",
    "2DCODE": "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",
    "TESTCTX": {
        "VERSION": 1,
        "SCHEMA": "1.0.0",
        "CERTIFICATE": "MIIBvTCCAWOgAwIBAgIKAXk8i88OleLsuTAKBggqhkjOPQQDAjA2MRYwFAYDVQQDDA1BVCBER0MgQ1NDQSAxMQswCQYDVQQGEwJBVDEPMA0GA1UECgwGQk1TR1BLMB4XDTIxMDUwNTEyNDEwNloXDTIzMDUwNTEyNDEwNlowPTERMA8GA1UEAwwIQVQgRFNDIDExCzAJBgNVBAYTAkFUMQ8wDQYDVQQKDAZCTVNHUEsxCjAIBgNVBAUTATEwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASt1Vz1rRuW1HqObUE9MDe7RzIk1gq4XW5GTyHuHTj5cFEn2Rge37+hINfCZZcozpwQKdyaporPUP1TE7UWl0F3o1IwUDAOBgNVHQ8BAf8EBAMCB4AwHQYDVR0OBBYEFO49y1ISb6cvXshLcp8UUp9VoGLQMB8GA1UdIwQYMBaAFP7JKEOflGEvef2iMdtopsetwGGeMAoGCCqGSM49BAMCA0gAMEUCIQDG2opotWG8tJXN84ZZqT6wUBz9KF8D+z9NukYvnUEQ3QIgdBLFSTSiDt0UJaDF6St2bkUQuVHW6fQbONd731/M4nc=",
        "VALIDATIONCLOCK": "2021-05-03T20:00:00+02:00",
        "DESCRIPTION": "VALID: AT: RAT test"
    },
    "EXPECTEDRESULTS": {
        "EXPECTEDVALIDOBJECT": true,
        "EXPECTEDSCHEMAVALIDATION": true,
        "EXPECTEDDECODE": true,
        "EXPECTEDVERIFY": true,
        "EXPECTEDUNPREFIX": true,
        "EXPECTEDVALIDJSON": true,
        "EXPECTEDCOMPRESSION": true,
        "EXPECTEDB45DECODE": true,
        "EXPECTEDPICTUREDECODE": true
    }
}
]
"""
}

struct TestData {
    let encodedEhnCert : String
    let keyId : String
    let encodedSigningCert : String
}

struct EuTestData : Decodable {
    let jsonContent: EuHealthCert
    let cborHex: String?
    let coseHex: String?
    let base45EncodedAndCompressed: String?
    let prefixed: String?
    let base64BarcodeImage: String?
    let testContext: TestContext
    let expectedResults: ExpectedResults
    
    enum CodingKeys: String, CodingKey {
        case jsonContent = "JSON"
        case cborHex = "CBOR"
        case coseHex = "COSE"
        case base45EncodedAndCompressed = "BASE45"
        case prefixed = "PREFIX"
        case base64BarcodeImage = "2DCODE"
        case testContext = "TESTCTX"
        case expectedResults = "EXPECTEDRESULTS"
    }
}

struct TestContext : Decodable {
    let version: Int?
    let schemaVersion: String?
    let signingCertificate: String?
    let validationClock: Date?
    let description: String
    
    enum CodingKeys: String, CodingKey {
        case version = "VERSION"
        case schemaVersion = "SCHEMA"
        case signingCertificate = "CERTIFICATE"
        case validationClock = "VALIDATIONCLOCK"
        case description = "DESCRIPTION"
    }
}

struct ExpectedResults : Decodable {
    let isValidObject: Bool?
    let isSchemeValidatable : Bool?
    let isEncodable: Bool?
    let isDecodable: Bool?
    let isVerifiable: Bool?
    let isUnprefixed: Bool?
    let isValidJson: Bool?
    let isBase45Decodable: Bool?
    let isImageDecodable: Bool?
    let isExpired: Bool?
    
    enum CodingKeys: String, CodingKey {
        case isValidObject = "EXPECTEDVALIDOBJECT"
        case isSchemeValidatable  = "EXPECTEDSCHEMAVALIDATION"
        case isEncodable = "EXPECTEDENCODE"
        case isDecodable = "EXPECTEDDECODE"
        case isVerifiable = "EXPECTEDVERIFY"
        case isUnprefixed = "EXPECTEDUNPREFIX"
        case isValidJson = "EXPECTEDVALIDJSON"
        case isBase45Decodable = "EXPECTEDB45DECODE"
        case isImageDecodable = "EXPECTEDPICTUREDECODE"
        case isExpired = "EXPECTEDEXPIRATIONCHECK"
    }
}
